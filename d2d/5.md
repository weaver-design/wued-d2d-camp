# D2D é›†è®­è¥ç¬¬5æœŸ

å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¼šåœ¨é¡µé¢ä½¿ç”¨ js çš„åŸºç¡€è¯­æ³•éå†æ•°æ®å¹¶å¾€é¡µé¢æ’å…¥ htmlï¼Œè¿™æ—¶å€™æ•°æ®æ˜¯å†™æ­»çš„ï¼Œå¦‚æœæ•°æ®æ˜¯ä»æœåŠ¡å™¨åŠ¨æ€åŠ è½½çš„å‘¢ï¼Ÿæœ¬æ¬¡åŸ¹è®­å°±å›´ç»• ajax æŠ€æœ¯å’Œ web åº”ç”¨æ¶æ„æ¥å±•å¼€ã€‚

æ—¥æœŸï¼š2019/06/25

åœ°ç‚¹ï¼šWeaTech 526 å°ä¼šè®®å®¤

## ğŸ¥‡ åŸ¹è®­å¤§çº²

- å·¥ç¨‹å¸ˆè§£å†³é—®é¢˜çš„æ€è·¯
  - å‘ç°é—®é¢˜
  - å®šä½é—®é¢˜
  - ä¸ªæ€§é—®é¢˜è½¬åŒ–æˆå…±æ€§é—®é¢˜
  - æœç´¢å¼•æ“å…¨ç½‘æŸ¥è¯¢
- Web åº”ç”¨ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ
  - å®¢æˆ·ç«¯
  - æœåŠ¡å™¨
  - Http è¯·æ±‚
- æµè§ˆå™¨ä¸­ä½¿ç”¨ Ajax å‘èµ·è¯·æ±‚
  - `$.get()` å‘èµ·è¯·æ±‚åŠ è½½æœ¬åœ°é™æ€æ•°æ®
  - `$().load()` å‘èµ·è¯·æ±‚åŠ è½½ html ç‰‡æ®µ
  - `$.get()` å‘èµ·è¯·æ±‚åŠ è½½å…¶ä»–æœåŠ¡å™¨ä¸ŠåŠ¨æ€æ•°æ®

## ğŸ“š åŸ¹è®­å†…å®¹

æœ¬æ¬¡è¯¾ç¨‹ä¸»è¦å›´ç»• Web åº”ç”¨çš„åŸºæœ¬æ¶æ„ï¼Œå¸®åŠ©å¤§å®¶è®¤æ¸…æ•´ä¸ª Web ç³»ç»Ÿçš„åŸºæœ¬æ¨¡æ ·ï¼Œä»¥åŠè‡ªèº«æ‰€å¤„çš„ä½ç½®ã€‚

### 1ï¼‰Web å‰ç«¯æ¶æ„æ¼”å˜å²

å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ `https://www.weaver.com.cn/` æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

**ä¼ ç»Ÿæ¶æ„**

![ä¼ ç»Ÿæ¶æ„](../img/architecture-old.png)

æœåŠ¡ç«¯é€šè¿‡ phpã€jspã€asp ç­‰æ¨¡æ¿æŠ€æœ¯ï¼Œåœ¨æœåŠ¡å™¨ä¸­æ¸²æŸ“å‡ºæµè§ˆå™¨èƒ½è¿è¡Œçš„çº¯ `html`ï¼Œå‘é€è‡³æµè§ˆå™¨ã€‚

``` php
<html>
  <head><title>Car {{ $car->id }}</title></head>
  <body>
    <h1>Car {{ $car->id }}</h1>
    <ul>
      <li>Make: {{ $car->make }}</li>
      <li>Model: {{ $car->model }}</li>
      <li>Produced on: {{ $car->produced_on }}</li>
    </ul>
  </body>
</html>
```

**å•é¡µåº”ç”¨æ¶æ„**

![å•é¡µåº”ç”¨æ¶æ„](../img/architecture-new.png)

æœåŠ¡ç«¯ä¸å†è´Ÿè´£æ¸²æŸ“é¡µé¢ï¼Œè€Œæ˜¯é€šè¿‡ `Ajax` æŠ€æœ¯å‘é¡µé¢å‘é€æ•°æ®ï¼Œå®¢æˆ·ç«¯çš„ `js` å°†æ•°æ®åŠ¨æ€æ¸²æŸ“è‡³ `html`.

```js
var renderCard = function(datas) {
  var templete = '';
  for(var i =0; i<datas.length; i++) {
    var tag = '' 
    + '<div class="col-xl-3 col-md-6 mb-4">'
    +   '<div class="card border-0 shadow showcase-img">'
    +     '<img src="'+ datas[i].avatar +'" class="card-img-top" alt="'+ datas[i].name +'">'
    +     '<div class="card-body text-center">'
    +       '<h5 class="card-title mb-0">'+ datas[i].name +'</h5>'
    +       '<div class="card-text text-black-50">'+ datas[i].role +'</div>'
    +     '</div>'
    +   '</div>'
    + '</div>';
    templete = templete + tag;
  }
  document.getElementById('wued_cards').innerHTML = templete;
}
$.get('/api/wued', function(res) {
  renderCard(res);
})
```

### 2ï¼‰Web åº”ç”¨æ¶æ„å›¾

ç°åœºä½¿ç”¨ Adobe XD ç»˜åˆ¶æ¶æ„å›¾ï¼Œæ–¹ä¾¿å­¦å‘˜ç†è§£æ•´ä½“ç½‘ç»œè¿è¡Œæ¶æ„ï¼š

![Web æ¶æ„å›¾](../img/a14d664ecadfbc0be8107de23f727b2.jpg)

### 3ï¼‰Ajax æŠ€æœ¯

[Ajax](https://developer.mozilla.org/en-US/docs/Web/Guide/AJAX) æ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„é¡µé¢åŠ¨æ€åŠ è½½æŠ€æœ¯ï¼Œè¯·æŸ¥é˜…ä½¿ç”¨æ–‡æ¡£ [Jquery å‡½æ•°å­—å…¸ Ajax ç¯‡](http://jquery.cuishifeng.cn/jQuery.get.html)

![Ajax æŠ€æœ¯æ¶æ„å›¾](https://mir-s3-cdn-cf.behance.net/project_modules/1400/8bd61e82085733.5d12deedbbf3d.png)

### ç”¨ä¾‹ä¸€

å‘èµ· `ajax` è¯·æ±‚ç»™æœ¬åœ°æœåŠ¡å™¨ï¼ŒåŠ è½½äººå‘˜å¡ç‰‡çš„é™æ€æ•°æ®

``` js
// å‘èµ· ajax è¯·æ±‚ç»™æœ¬åœ°æœåŠ¡å™¨ï¼ŒåŠ è½½äººå‘˜å¡ç‰‡çš„é™æ€æ•°æ®
$.get('./wued.json', function(res) {
  renderCard(res);
})
```

### ç”¨ä¾‹äºŒ

å‘èµ· `ajax` è¯·æ±‚ç»™æœ¬åœ°æœåŠ¡å™¨ï¼ŒåŠ è½½å…¬å…±é¡µé¢ HTML ç‰‡æ®µ

``` js
// å‘èµ· ajax è¯·æ±‚ç»™æœ¬åœ°æœåŠ¡å™¨ï¼ŒåŠ è½½å…¬å…±é¡µé¢ HTML ç‰‡æ®µ
$('#wued_footer').load("./footer.html", function() {
  console.log('footer åŠ è½½å®Œæˆ');
})
```

### ç”¨ä¾‹ä¸‰

å‘èµ· `ajax` è¯·æ±‚ç»™å…¶ä»–æœåŠ¡å™¨ï¼ŒåŠ è½½äººå‘˜å¡ç‰‡çš„åŠ¨æ€æ•°æ®

ä¾‹å¦‚ï¼šåç«¯æä¾›ä¸€ä¸ªåŠ¨æ€æ•°æ®æ¥å£ `https://wued-code-camp.herokuapp.com/api/wued`ï¼ˆå¯åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•ï¼‰

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åœ¨æµè§ˆå™¨ä¸­å‘èµ·è¯·æ±‚ä½¿ç”¨çš„è¿™ä¸ªæ¥å£å‘¢ï¼Ÿ

``` js
$.get('https://wued-code-camp.herokuapp.com/api/wued', function(res) {
  renderCard(res);
})
```

æ³¨ï¼šç”±äºæµè§ˆå™¨ç«¯æœ‰[æµè§ˆå™¨åŒæºç­–ç•¥è¯·æ±‚é™åˆ¶](https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy)ï¼Œéœ€è¦é…ç½®æœ¬åœ° VS Code ä¸­ live server æ’ä»¶çš„ä»£ç†æœåŠ¡

```json
{
  "liveServer.settings.host": "192.168.30.175",
  "liveServer.settings.port": 5500,
  "liveServer.settings.proxy": {
    "enable": true,
    "baseUri": "/api",
    "proxyUri": "https://wued-code-camp.herokuapp.com/api"
  }
}
```

è¿™ä¸ªæ—¶å€™ live server ä¼šå¸®æˆ‘ä»¬æŠŠ `http://localhost:5500/api/wued` è¯·æ±‚ä»£ç†è½¬å‘åˆ° `https://wued-code-camp.herokuapp.com/api/wued`ã€‚

``` js
$.get('/api/wued', function(res) {
  renderCard(res);
})
```

æˆåŠŸè§£å†³è·¨åŸŸè®¿é—®é™åˆ¶ï¼Œè¯·æ±‚åˆ°çœŸå®æ•°æ®ã€‚

## âœï¸ è¯¾åä½œä¸š

æœ¬æ¬¡è¯¾ç¨‹å†…å®¹è¾ƒå¤šï¼Œæš‚æ— è¯¾åä½œä¸šï¼Œç­‰å¾…ä¸‹æœŸå¸ƒç½®ã€‚

## ğŸ’¯ ç»ƒä¹ èµ„æ–™

è¯·å‚è€ƒ `wued-code-camp\examples\AJAX`ï¼Œ`compelete` ä¸ºå‚è€ƒç­”æ¡ˆï¼Œ`initial` ä¸­å¯ä»¥è‡ªè¡Œå¯¹ç…§ç»ƒä¹ ã€‚

## ğŸ“‘ å‚è€ƒèµ„æ–™

[1] [æµè§ˆå™¨çš„åŒæºç­–ç•¥.MDN Web Docs](https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy)

[2] [Jquery å‡½æ•°å­—å…¸ Ajax ç¯‡](http://jquery.cuishifeng.cn/jQuery.get.html)

[3] [Asynchronous JavaScript + XML](https://developer.mozilla.org/en-US/docs/Web/Guide/AJAX)